-- Create database
CREATE DATABASE unifest_2026;
USE unifest_2026;

-- Colleges table
CREATE TABLE colleges (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    username VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Competitions table
CREATE TABLE competitions (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(255) NOT NULL,
    category ENUM('technical', 'cultural', 'sports') NOT NULL,
    type ENUM('individual', 'group') NOT NULL,
    max_participants INT NOT NULL,
    venue VARCHAR(255) NOT NULL,
    event_datetime DATETIME NOT NULL,
    registration_deadline DATETIME NOT NULL,
    status ENUM('open', 'closed') DEFAULT 'open',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Students table
CREATE TABLE students (
    id INT PRIMARY KEY AUTO_INCREMENT,
    college_id INT,
    name VARCHAR(255) NOT NULL,
    roll_number VARCHAR(100) NOT NULL,
    department VARCHAR(255) NOT NULL,
    year ENUM('1', '2', '3', '4') NOT NULL,
    email VARCHAR(255),
    phone VARCHAR(20),
    FOREIGN KEY (college_id) REFERENCES colleges(id)
);

-- Registrations table
CREATE TABLE registrations (
    id INT PRIMARY KEY AUTO_INCREMENT,
    student_id INT,
    competition_id INT,
    registered_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status ENUM('pending', 'confirmed') DEFAULT 'pending',
    FOREIGN KEY (student_id) REFERENCES students(id),
    FOREIGN KEY (competition_id) REFERENCES competitions(id)
);

-- Marks table
CREATE TABLE marks (
    id INT PRIMARY KEY AUTO_INCREMENT,
    student_id INT,
    competition_id INT,
    marks_obtained DECIMAL(5,2),
    judge_number INT,
    status ENUM('pending', 'submitted', 'verified') DEFAULT 'pending',
    evaluated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (student_id) REFERENCES students(id),
    FOREIGN KEY (competition_id) REFERENCES competitions(id)
);
